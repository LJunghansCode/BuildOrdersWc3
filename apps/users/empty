TODO
Move all auth stuff to here.